




<!DOCTYPE html>
<html lang="en">
  <head>
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-2000254-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-2000254-3');
</script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>


    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../../../../media/static/favicon.ico">

	
  <title>Blogs | Michele Pasin</title>


    <!-- Bootstrap core CSS -->
    
    <!-- Bootswatch:  -->
    <!-- cerulean  | cyborg |  flatly |  lumen |  sandstone |   spacelab  |  yeti | cosmo |  darkly |  paper | simplex | superhero |  journal | readable  |   slate |  united -->
    <link href="../../../../../media/static/libs/bootswatch3.2/simplex/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="../../../../../media/static/libs/bootstrap-3.3.7-dist/css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../../../../../media/static/libs/bootstrap-3.3.7-dist/css/sticky-footer-navbar.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

<style type="text/css">

    .tooltip-inner {
        max-width: 200px;
        /* If max-width does not work, try using width instead */
        width: 200px; 
    }
    .lead-plus {font-size: 26.5px;}
    .label-dark {background: #2c3e50; color: white; padding: 1px;}
    .margin50 {margin-top: 50px; margin-bottom: 50px;}
    .marginb100 {margin-bottom: 100px;}

    .breadcrumbs {margin-top: 80px;}
    .namespaces {background: #ced2d6; width: 100%;}
    .footer {background-color: #3e3f3a;}
    .footer a {color: #cac0bf;}

    .margin50Top {margin-top: 50px;}
    .margin20Top {margin-top: 20px;}
    .margin50Bottom { margin-bottom: 50px;}
    .margin20Bottom { margin-bottom: 20px;}

    /*so that the d3plus tooltip panel doesnt cover the top banner*/
    .navbar {z-index: 3000;}


    .navbar-alpha {
        font-size: 65%;
        font-style: italic;
        font-weight: bold;
        color: darkgoldenrod;
    }


    .btn-xxs {
    padding: 1px 4px;
    font-size: 10px;
    line-height: 1.2;
    border-radius: 2px;
    }


    .code-example {
        overflow: auto;
        height: 400px;
    }


    #side_title a {
        color: blue;
        text-decoration: underline;

    }
    .text-dark {
        color: #5d5c5c;
        
    }


    .paragraph_embed {
      margin-top: 50px;
      margin-bottom: 20px;
    }


    .thumb-div {
      padding: 20px;

    }

    .thumbnail{
      

      

    }

    .thumb-img {
      height: 200px;

    }

    .thumb-title b {
      font-weight: bold;
      color: black;

    }

    div.pubitem {
      margin-top: 15px;
    }



    a.project-title {
      color: black;
      font-weight: bold;
      text-decoration: none;
    }

    a.project-title:hover {
      background: indianred;
      color: white;
    }

    a.project-active {
      background: indianred;
      color: white;
    }

    .keyword {
      font-style: italic;
      color: grey;
      text-decoration: none;
      font-size: 12px;
    }

    a.paper-active {
      background: indianred;
      color: white;
    }

    a.ext_link {
      color: darkgrey;
    }

    .text-black {
      color: black;
    }

    a.sounds-active {
      background: indianred;
      color: white;
    }

    img.project-screenshots {
      margin-botton: 30px;
    }



    


    h2.blogtitle {
      color: black;
      margin-top: 40px;
    }


    .blogentry {
      font-size: 1.3em;
      margin-top: 50px;
      margin-bottom: 120px;
      color: #444;
      /* font-family: "Helvetica Neue", Helvetica, Arial, Sans-Serif;  */
    }

    .blogentry p.first-paragraph {
      font-weight: bold;
      font-size: 1.1em;
    }

    .blogentry p {
      margin-top: 30px;
      margin-bottom: 30px;
    }

    .blogentry div {
      margin-top: 20px;
      margin-bottom: 20px;
    }

    .blogentry blockquote:first-of-type {
      font-size: 20px;
      font-weight: normal;
      background: #f9f9f9;
      border-left: 10px solid #ccc;
      margin: 1.5em 10px;
      padding: 0.7em 10px;
    }


    .blogentry blockquote {
      font-size: 16px;
      background: #f9f9f9;
      margin: 10px 30px 40px 10px; /* top right bottom left */
      padding: 25px;
    }

    .blogentry pre {
      margin-bottom: 40px;
    }

    .blogentry h1,  
    .blogentry h2,  
    .blogentry h3,  
    .blogentry h4  {
      margin-top: 50px;
      margin-bottom: 30px;
      font-weight: bold;
      color: #000;
    }

    .blogentry img {
      max-width: 80%;
      margin-top: 20px;
      margin-bottom: 20px;
    }

    .blogentry iframe {
      margin-top: 20px;
      margin-bottom: 20px;
    }

    .blogentry ul {
      margin-bottom: 20px;
    }

    .blogentry li {
      padding: 5px;
    }


</style>


<style>

pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.codehilite .hll { background-color: #ffffcc }
.codehilite { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */


</style>







  </head>

  <body>





    

    


<!-- Fixed navbar -->
<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../../../../index.html">michelepasin<sup style="color: red;">&nbsp;.org</sup></a>
    </div>
    <div id="navbar" class="collapse navbar-collapse">
      <ul class="nav navbar-nav">

        <li >
          <a href="../../../../../index.html">Projects</a></li>

        <li class="active">
            <a href="../../../../../words/index.html">Words</a></li>

       <li >
            <a href="../../../../../sounds/index.html">Sounds</a></li>

        <li >
          <a href="../../../../../events/index.html">Events</a></li>
          
          

        <li 
        
          ><a href="../../../../../about/index.html">About</a></li>

          <!-- <li>
            <a href="/blog" target="_blank">Blog</a></li> -->
            

      </ul>
    </div><!--/.nav-collapse -->

  </div>
</nav>


    








    <!-- Begin page content -->
    <div class="container">


	


  <div class="container">


      <div class="row" style="margin-bottom:50px;">
          
        <div class="col-md-7">



          <div>
            <h2 class="blogtitle"><b>Clojure or not clojure?</b></h2>
          </div>
          

          <!-- <p>Nov. 25, 2010</p> -->

          

            <div class="blogentry"> 

              <hr>


            <p><a href="http://clojure.org/">Clojure</a> is a quite recent programming language that's becoming popular among developers; the big selling point is that it's <a href="http://clojure.org/state">functional</a> and <a href="http://en.wikipedia.org/wiki/Dynamic_typing#Dynamic_typing">dynamically</a> typed (such as Lisp or Python), but since it uses Java's Virtual Runtime as its platform it also accommodates the needs of the many developers have been growing up in the Java world.</p>
<p>The book <a href="http://www.pragprog.com/titles/shcloj/programming-clojure">Programming Clojure</a> sums up well the pros of this language:</p>
<blockquote>
<p>Clojure is <strong>elegant</strong>. Clojure’s clean, careful design lets you write programs that get right to the essence of a problem, without a lot of clutter and ceremony. Clojure is <strong>Lisp reloaded</strong>. Clojure has the power inherent in Lisp, but is not constrained by the history of Lisp. Clojure is a <strong>functional</strong> language. Data structures are immutable, and functions tend to be side-effect free. This makes it easier to write correct programs, and to compose large programs from smaller ones. Clojure is <strong>concurrent</strong>. Rather than error-prone locking, Clojure provides software transactional memory. Clojure <strong>embraces Java</strong>. Calling from Clojure to Java is direct, and goes through no translation layer. Clojure is <strong>fast</strong>. Wherever you need it, you can get the exact same performance that you could get from hand-written Java code.</p>
</blockquote>
<p>I've been programming in Lisp for a while, then moved to Python in order to use something less dated and to be able to do more agile web development. But the strengths of Lisp, together with that kind of magic that comes with it (maybe coming from the <a href="http://en.wikipedia.org/wiki/Homoiconicity">code-as-data paradigm</a>) is something which I bet all Lisp programmers miss in other languages. So I decided to give Clojure a go..</p>
<p>Installation is surprisingly super easy - and I mean it - especially if you are on mac osX. Clojure is a java library, so all you have to do is <a href="http://clojure.org/getting_started">download the package and run it from the command line using your java compiler</a>. That gives you the basic interactive environment:</p>
<div class="codehilite"><pre><span></span><code>java -cp clojure.jar clojure.main
</code></pre></div>

<p>The interpreter is good for testing, but not for building large programs. So the next step is getting an IDE. Looks like there are <a href="http://www.bestinclass.dk/index.clj/2010/03/clojure-ides-the-grand-tour-getting-started.html">many choices available</a>, so just pick one of your liking. I personally love <a href="http://macromates.com/">TextMate</a> a lot, so I was happy to find out that there is a <a href="https://github.com/swannodette/textmate-clojure">clojure bundle</a> that contains all that you need to get started (yes, the clojure environment too, so you can even skip the step above). Easy beasy to install, but first you need to install <a href="https://github.com/ninjudd/cake">Cake</a>, a build tool that you can get via ruby's gem command (usually preinstalled on OSx). So:</p>
<div class="codehilite"><pre><span></span><code>sudo gem install cake
</code></pre></div>

<p>Then install Textmate's bundle for clojure like this:</p>
<div class="codehilite"><pre><span></span><code><span class="o">$</span> <span class="n">cd</span> <span class="o">~/</span><span class="n">Library</span><span class="o">/</span><span class="n">Application</span> <span class="n">Support</span><span class="o">/</span><span class="n">TextMate</span><span class="o">/</span><span class="n">Bundles</span>
<span class="o">$</span> <span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">swannodette</span><span class="o">/</span><span class="n">textmate</span><span class="o">-</span><span class="n">clojure</span><span class="o">.</span><span class="n">git</span> <span class="n">Clojure</span><span class="o">.</span><span class="n">tmbundle</span>
<span class="o">$</span> <span class="n">osascript</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;tell app &quot;TextMate&quot; to reload bundles&#39;</span>
</code></pre></div>

<p>I don't use Ruby, so the final step for me was adding to the system path the location of ruby's gems (so that Cake can be run from Textmate). Open up you ~/.bash_profile and add this line:</p>
<div class="codehilite"><pre><span></span><code><span class="k">export</span> <span class="n">PATH</span><span class="o">=</span><span class="s2">&quot;/Users/mike/.gem/ruby/1.8/bin:$PATH&quot;</span>
</code></pre></div>

<p>That's it! A nice fellow created a really good video tutorial about how to use Textmate with the Clojure bundle, so I was able to run my first application quite quickly:</p>
<p>Once you've familiarized with the environment, copy and paste the code below - it's an implementation of the Tetris game in clojure (which I found <a href="https://github.com/yogthos/Clojure-Tetris/blob/master/src/tetris.clj">here</a>). Very useful as a learning resource!</p>
<p>(ns tetris
  (:import
    (javax.swing JFrame)
    (java.awt Canvas Graphics Color Toolkit)
    (java.awt.event ActionListener KeyListener KeyEvent))
  (:gen-class))</p>
<p>(def <strong>*cols*</strong> 10)
(def <strong>*rows*</strong> 20)
(def <strong>*width*</strong> 300)
(def <strong>*height*</strong> 600)
(def <strong>*offset*</strong> (<strong>atom</strong> [0, 0]))
(def <strong>*rotation*</strong> (<strong>atom</strong> <strong>nil</strong>))
(def <strong>*shapes*</strong>  [[[0,1],[0,2],[0,3],[0,4]]
                [[0,0],[0,1],[1,1],[1,2]]
                [[1,2],[1,1],[0,1],[0,0]]
                [[0,0],[0,1],[1,0],[1,1]]
                [[0,0],[0,1],[0,2],[1,2]]
                [[1,0],[1,1],[1,2],[0,2]]])</p>
<p>(defn get-shape []
  (<strong>let</strong> [shape (rand-nth <strong>*shapes*</strong>)
        offset (inc (rand-int (<strong>-</strong> <strong>*cols*</strong> 3)))]
    (<strong>map</strong> (fn [[x y]] [(<strong>+</strong> x offset), y]) shape)))</p>
<p>(defn get-board []
  (vec (range (<strong>*</strong> <strong>*rows*</strong> <strong>*cols*</strong>))))</p>
<p>(defn pos-to-xy [pos]
  (<strong>let</strong> [x (<strong>mod</strong> pos <strong>*cols*</strong>)
        y (int (<strong>/</strong> (<strong>-</strong> pos x) <strong>*cols*</strong>))]
    [x, y]))</p>
<p>(defn collides?
  ([board x y pos]
    (<strong>let</strong> [[posx posy] (pos-to-xy pos)]
      (<strong>and</strong>
        (<strong>></strong> x (<strong>-</strong> 1))
        (<strong>&lt;</strong> x <strong>*cols*</strong>)
        (<strong>&lt;</strong> y <strong>*rows*</strong>)
        (<strong>not</strong> (<strong>and</strong>
              (<strong>\=</strong> posx x)
              (<strong>\=</strong> posy y)
              (<strong>not</strong> (<strong>get</strong> board (<strong>+</strong> pos <strong>*cols*</strong>))))))))
  ([board shape pos]
    (<strong>every</strong>?
      #{true}
      (for [[x y] shape]
       (collides? board x y pos))))
  ([board shape]
    (<strong>not</strong> (<strong>reduce</strong>
           #(<strong>and</strong> %1 (collides? board shape %2))
          (range (<strong>count</strong> board)))) ))</p>
<p>(defn rotate [board shape]
  (<strong>if</strong> (<strong>nil</strong>? @*rotation*)
    shape
    (<strong>let</strong> [[avg-x avg-y] (-&gt;&gt; shape
                          (<strong>reduce</strong>
                            (fn [[tx ty] [x y]]
                              [(<strong>+</strong> tx x), (<strong>+</strong> ty y)]))
                          (<strong>map</strong> #(int (<strong>/</strong> % 4))))</p>
<div class="codehilite"><pre><span></span><code>      <span class="nv">rotated</span> <span class="ss">(</span><span class="o">**</span><span class="nv">map</span><span class="o">**</span> <span class="ss">(</span><span class="nv">fn</span> \[\[<span class="nv">x</span> <span class="nv">y</span>\]\]
                     \[<span class="ss">(</span><span class="nv">int</span> <span class="ss">(</span><span class="o">**+**</span> <span class="nv">avg</span><span class="o">-</span><span class="nv">x</span> <span class="ss">(</span><span class="o">**</span>\<span class="o">-**</span> <span class="nv">y</span> <span class="nv">avg</span><span class="o">-</span><span class="nv">y</span><span class="ss">)))</span>
                      <span class="ss">(</span><span class="nv">int</span> <span class="ss">(</span><span class="o">**</span>\<span class="o">-**</span> <span class="nv">avg</span><span class="o">-</span><span class="nv">y</span> <span class="ss">(</span><span class="o">**</span>\<span class="o">-**</span> <span class="nv">x</span> <span class="nv">avg</span><span class="o">-</span><span class="nv">x</span><span class="ss">)))</span>\]<span class="ss">)</span>
                <span class="nv">shape</span><span class="ss">)</span>\]
  <span class="ss">(</span><span class="o">**</span><span class="k">if</span><span class="o">**</span> <span class="ss">(</span><span class="nv">collides</span>? <span class="nv">board</span> <span class="nv">rotated</span><span class="ss">)</span>
    <span class="nv">shape</span> <span class="nv">rotated</span><span class="ss">))))</span>
</code></pre></div>

<p>(defn shift [board shape]
  (<strong>let</strong> [shifted (<strong>map</strong>
                  (fn [[x y]]
                    [(<strong>+</strong> x (<strong>first</strong> @*offset*)), y])
                  shape)]
    (<strong>if</strong> (collides? board shifted)
      shape shifted)))</p>
<p>(defn transform [board shape drop?]
  (<strong>let</strong> [shifted (shift board shape)
        rotated (rotate board shifted)]
    (<strong>if</strong> drop?
      (<strong>map</strong> (fn [[x y]]
             [x, (<strong>if</strong> drop? (inc y) y)]) rotated)
      rotated)))</p>
<p>(defn clear-lines [board]
  (<strong>let</strong> [new-board (<strong>apply</strong> concat
                    (filter #(<strong>some</strong> #{true} %)
                      (partition <strong>*cols*</strong> board)))]
    (into
      (vec (<strong>map</strong> (fn [_] true)
             (range (<strong>-</strong> (<strong>count</strong> board) (<strong>count</strong> new-board)))))
      new-board)))</p>
<p>(defn update-board [board shape]
  (vec (<strong>map</strong> #(<strong>let</strong> [[x y] (pos-to-xy %)]
               (<strong>if</strong> (<strong>some</strong>
                     (fn [[px py]] (<strong>and</strong>(<strong>\=</strong> x px) (<strong>\=</strong> y py)))
                     shape)
                 false (<strong>get</strong> board %)))
         (range (<strong>count</strong> board)))))</p>
<p>(defn game-over? [board]
  (<strong>not</strong> (<strong>reduce</strong> #(<strong>and</strong> %1 %2)
         (<strong>butlast</strong> (<strong>rest</strong> (take <strong>*cols*</strong> board))))))</p>
<p>;;;;;;Controls;;;;
(def <strong>*dirs*</strong> {KeyEvent/VK_LEFT  [-1, 0]
             KeyEvent/VK_RIGHT [1, 0]
             KeyEvent/VK_UP :left
             KeyEvent/VK_DOWN :right})</p>
<p>(defn handle-input [#^KeyEvent event]
  (<strong>let</strong> [key (.getKeyCode event)]
    (<strong>cond</strong>
      (<strong>or</strong> (<strong>\=</strong> key KeyEvent/VK_LEFT) (<strong>\=</strong> key KeyEvent/VK_RIGHT))
      (<strong>let</strong> [disp (<strong>*dirs*</strong> key)]
        (<strong>when</strong> disp (swap! <strong>*offset*</strong> #(<strong>map</strong> <strong>+</strong> disp %))))
      (<strong>or</strong> (<strong>\=</strong> key KeyEvent/VK_UP) (<strong>\=</strong> key KeyEvent/VK_DOWN))
      (reset! <strong>*rotation*</strong> (<strong>*dirs*</strong> key)))))</p>
<p>(defn input-listener []
  (proxy [ActionListener KeyListener] []
    (actionPerformed [e])
    (keyPressed [e] (handle-input e))
    (keyReleased [e])
    (keyTyped [e])))</p>
<p>;;;;;;;UI;;;;;;;;;
(defn draw [#^Canvas canvas draw-fn]
  (<strong>let</strong> [buffer  (.getBufferStrategy canvas)
        g       (.getDrawGraphics buffer)]
    (try
      (draw-fn g)</p>
<div class="codehilite"><pre><span></span><code>  <span class="ss">(</span><span class="nv">finally</span> <span class="ss">(</span>.<span class="nv">dispose</span> <span class="nv">g</span><span class="ss">)))</span>
<span class="ss">(</span><span class="o">**</span><span class="k">if</span><span class="o">**</span> <span class="ss">(</span><span class="o">**</span><span class="nv">not</span><span class="o">**</span> <span class="ss">(</span>.<span class="nv">contentsLost</span> <span class="nv">buffer</span><span class="ss">))</span>
  <span class="ss">(</span>. <span class="nv">buffer</span> <span class="k">show</span><span class="ss">))</span>
<span class="ss">(</span>.. <span class="nv">Toolkit</span> <span class="ss">(</span><span class="nv">getDefaultToolkit</span><span class="ss">)</span> <span class="ss">(</span><span class="nv">sync</span><span class="ss">))))</span>
</code></pre></div>

<p>(defn draw-square [x y #^Graphics g]
  (<strong>let</strong> [width  (<strong>/</strong> <strong>*width*</strong> <strong>*cols*</strong>)
        height (<strong>/</strong> <strong>*height*</strong> <strong>*rows*</strong>)
        xpos   (<strong>*</strong> x width)
        ypos   (<strong>*</strong> y width)]
    (doto g
      (.setColor Color/RED)
      (.fillRect xpos, ypos, width, height)
      )))</p>
<p>(defn draw-game-over [#^Graphics g]
  (doto g
   (.setColor Color/BLACK)
   (.fillRect 0 0 <strong>*width*</strong> <strong>*height*</strong>)
   (.setColor Color/green)
   (.drawString "GAME OVER" (<strong>-</strong> (<strong>/</strong> <strong>*width*</strong> 2) 50)  (<strong>/</strong> <strong>*height*</strong> 2))))</p>
<p>(defn draw-board [board shape]
  (fn [#^Graphics g]
    (doto g
      (.setColor Color/BLACK)
      (.fillRect 0 0 <strong>*width*</strong> <strong>*height*</strong>))</p>
<div class="codehilite"><pre><span></span><code>(doseq \[square (range (**count** board))\]
  (**when** (**not** (**get** board square))
   (**let** \[\[x y\] (pos-to-xy square)\]
     (draw-square x y g))))

(doseq \[\[x y\] shape\]
  (draw-square x y g))))
</code></pre></div>

<p>(defn -main [&amp; args]
  (<strong>let</strong> [frame  (JFrame. "Tetris")
        canvas (Canvas.)]
    (doto frame
      (.setSize <strong>*width*</strong> (<strong>+</strong> (<strong>/</strong> <strong>*height*</strong> <strong>*rows*</strong>) <strong>*height*</strong>))
      (.setDefaultCloseOperation JFrame/EXIT_ON_CLOSE)
      (.setResizable false)
      (.add canvas)
      (.setVisible true))</p>
<div class="codehilite"><pre><span></span><code>(doto canvas
  (.createBufferStrategy 2)
  (.addKeyListener (input-listener))
  (.setVisible true)
(.requestFocus))

<span class="c">;;game loop</span>
(**loop** \[board    (get-board)
       shape    (get-shape)
       old-time (System/currentTimeMillis)\]

  (reset! **\*offset\*** \[0,0\])
  (reset! **\*rotation\*** **nil**)
  (Thread/sleep 10)
  (draw canvas (draw-board board shape))

  (**let** \[cur-time (System/currentTimeMillis)
        new-time (long (**if** (**\&gt;** (**\-** cur-time old-time) 150)
                         cur-time
                         old-time))
        drop?    (**\&gt;** new-time old-time)\]
    (**cond**
      (game-over? board)
      (draw canvas draw-game-over)

      (collides? board shape)
      (recur (update-board board shape)
        (get-shape)
      new-time)

      **:default**
      (recur
        (clear-lines board)
        (transform board shape drop?)
        new-time)
      )))))
</code></pre></div>

<p>(-main)</p>
<p>Quite amazing isn'it? However, the very next question for me was, why investing time and money into this new language? It's definitely interesting, but does it compare to python and django (for example) when it comes to build social web apps? Can't really answer to these questions at the moment, but I found really useful the conclusions of an article I found online (on <a href="http://java.ociweb.com/mark/clojure/article.html">Java News Brief</a>):</p>
<blockquote>
<p>• Are you looking for a way to make concurrent programming easier? • Are you open to branching outside the world of object-oriented programming to try functional programming? • Is it important for the applications you write to run on the JVM in order to take advantage of existing Java libraries, portability and other benefits? • Do you prefer dynamically-typed languages over statically-typed ones? • Do you find the minimal, consistent syntax of Lisp dialects appealing? If you answered "yes" some of these questions then you should consider using Clojure as your next programming language.</p>
</blockquote>
<p>Finally, a couple of other useful learning resources:</p>
<p>- <a href="http://mark.reid.name/sap/setting-up-clojure.html">setting up clojure on mac osX Leopard</a> - <a href="http://clojure.blip.tv/">clojure for lisp programmers</a> (video lecture) - <a href="http://www.moxleystratton.com/article/clojure/for-non-lisp-programmers">Clojure Tutorial For the Non-Lisp Programmer</a> - a clojure <a href="http://java.ociweb.com/mark/clojure/ClojureSnake.html">implementation of the snake game</a></p>
<p>...</p>

            </div>


          <hr>
            <p class="text-muted">Cite this blog post:</p>

            <div class="well well-big">
              Michele Pasin. <a href="index.html" class="bluelink">Clojure or not clojure?</a>. Blog post on www.michelepasin.org. Published on Nov. 25, 2010.
            </div>
            <br />


            
            <p class="text-muted">Linkout:</p>

            <div class="-lead">

              
              <li><a href="https://www.michelepasin.org/archived/blog/2010/11/25/clojure-or-not-clojure/index.html">Legacy Blog</a></li>
                
              

            </div>
            <br />
            
        


          <br /><br />


        </div> 
        
      

        <div class="col-md-2 col-md-offset-1">

          <p style="color: #e8e5e5; margin-top: 10px;">
          <span style="font-size: 500%;">
					  Nov
					</span>
          <span style="font-size: 700%;">
					  2010
					</span>
          </p>


        </div>
        
      </div>




      

      





    <div class="row">
      <h5 class="text-muted">See also:</h5>
      </div>


      

      <div class="row row_pubitem">

        <hr>

        <div class="col-sm-2 col-md-3">
          <p style="color: lightgrey; font-size: 300%; ">2011</p>
        </div>


        <div class="col-sm-7 col-md-9">


        

        <br />

          <div class='pubitem'>


            
            <p class='lead' style="font-size: 13px;">
              <span class='label label-info'>blog</span>&nbsp;
              <a href="../../../../2011/01/21/live-coding-in-clojure/index.html" class="bluelink " >Live coding in clojure</a>
              <!-- <br /> -->
              <!-- <span class="">Michele Pasin</span> -->
            </p>

            





            


          </div>

        


        </div>



      </div>

      

      <div class="row row_pubitem">

        <hr>

        <div class="col-sm-2 col-md-3">
          <p style="color: lightgrey; font-size: 300%; ">2010</p>
        </div>


        <div class="col-sm-7 col-md-9">


        

        <br />

          <div class='pubitem'>


            
            <p class='lead' style="font-size: 13px;">
              <span class='label label-info'>blog</span>&nbsp;
              <a  class="bluelink paper-active" title="The article on this page">Clojure or not clojure?</a>
              <!-- <br /> -->
              <!-- <span class="">Michele Pasin</span> -->
            </p>

            





            


          </div>

        


        </div>



      </div>

      








    <div class="row" style="margin-top: 60px;">
    &nbsp;
    </div> 
    



  </div> <!-- /container -->





	</div>


  



  




  <footer class="footer">
    <div class="container">
    
      <p class="text-muted">Find me also on: &nbsp;
      

  <a href="http://kcl.academia.edu/MichelePasin" target="_blank">Academia</a> | 
  <a href="https://github.com/lambdamusic" target="_blank">GitHub</a> | 
  <a href="https://scholar.google.com/citations?user=zj-99x0AAAAJ&hl=en" target="_blank">Google Scholar</a> | 
  <a href="https://www.instagram.com/lambdamusic/" target="_blank">Instagram</a> |
  <a href="http://www.linkedin.com/pub/michele-pasin/1/223/a0" target="_blank">LinkedIn</a> |
  <a href="http://www.mendeley.com/profiles/michele-pasin/" target="_blank">Mendeley</a> |
  <a href="http://orcid.org/0000-0001-8909-7766" target="_blank">Orcid</a> |
  <a href="http://www.slideshare.net/mpasin" target="_blank">SlideShare</a> |
  <a href="https://soundcloud.com/magicrebirth" target="_blank">Soundcloud</a> |
  <a href="http://stackoverflow.com/users/109304/magicrebirth" target="_blank">StackOverflow</a> |
  <a href="http://twitter.com/#!/lambdaman" target="_blank">Twitter</a> |
  <a href="https://vimeo.com/lambdamusic" target="_blank">Vimeo</a>
      
      </p>
    
    </div>
  </footer>


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../../../../../media/static/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../../../../../media/static/libs/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../../../../../media/static/libs/bootstrap-3.3.7-dist/js/ie10-viewport-bug-workaround.js"></script>


    


<script>

  $( document ).ready(function() {
    $("div.blogentry p:first").addClass( "first-paragraph" );
});


</script>




    

      



  </body>
</html>
